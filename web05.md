SSCTF 2016 quals Write-up
=====
AFSRC-Market (Web, 500p)
---

![alt-text][main_page]

Просмотрев главную страницу становится понятно, что форма поиска не функционирует.
При попытке добавить какой-либо товар в корзину появляетя просьба войти на сайт и
происходит редирект на страницу входа.
При нажатии на сами товары просиходит переход по ссылке `https://security.alipay.com/`.

![alt-text][alert_msg]

![alt-text][login_page]

На странице входа требуется ввести логин, пароль и капчу. Попытки использовать различные
служебные символы не приводят к неожиданному поведению сайта.
Перейдем к странице регистрации.

![alt-text][register_page]

Попробуем зарегистрировать какого-либо пользователя.

![alt-text][reg_success]

![alt-text][try_login]

Видим сообщение об успешной регистрации и нас перенаправляют на страницу входа. Пытаемся зайти и... Успех!

![alt-text][login_success]

В шапке сайта появились ссылки на профиль пользователя и кнопка выхода. Форма поиска как и раньше не функционирует.
Заметим, что после авторизации в cookie была добавлена единственное значение PHPSESSID - идентификатор сессии в PHP.
Теперь при попытке добавить товар в корзину осуществляется переход по ссылке вида
`http://edb24e7c.seclover.com/add_cart.php?id=XXX` где вместо `XXX` какой-нибудь номер.
После этого окрывается домашняя страница и больше ничего не происходит.
При попытке вставить в параметр `id` различные числа всегда появляется сообщение об успешном добавлении,
при вводе символов, не являющихся цифрами, выдается сообщние об ошибке. Также допистим ввод следующего типа: `id=0x123456`.
Это говорит о том, что параметр `id` скорее всего проверяетя с помощью PHP функции `is_numeric()` перед вставкой в запрос.

![alt-text][login_success]

Теперь рассмотрим страницу пользователя. В шапке сайта появляеся ссылка `AddMoney` на
`http://edb24e7c.seclover.com/addmoney.php`, при переходе по которой выводится сообщение.
Также имеются 3 переключаемые вкладки: `Description`, `Additional Information`, `MyInfo`.
Первые две вкладки не так интересны, т.к. скорее всего являются статическими, а третяя содержит форму
для добавления денег.

![alt-text][login_success]

[main_page]: https://github.com/adam-p/markdown-here/raw/master/src/common/images/icon48.png "Main page"
